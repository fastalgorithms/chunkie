function sixth = green_sixth(k,src,targ)
%CHNK.HELM2D.GREEN_SIXTH evaluate the sixth derivatives of the green's
%function for the given sources and targets

[~,ns] = size(src);
[~,nt] = size(targ);

xs = repmat(src(1,:),nt,1);
ys = repmat(src(2,:),nt,1);

xt = repmat(targ(1,:).',1,ns);
yt = repmat(targ(2,:).',1,ns);

rx = xt-xs;
ry = yt-ys;

rx2 = rx.*rx;
ry2 = ry.*ry;

r2 = rx2+ry2;

r = sqrt(r2);

[m,n] = size(xs);

h0 = besselh(0,1,k*r);
h1 = besselh(1,1,k*r);
sixth = zeros(m,n,7);
sixth(:,:,1) = k.*((-1).*h0.*k.*r.^(-10).*(rx.^6.*(60+(-9).*k.^2.*rx.^2+k.^4.* ...
  rx.^4)+rx.^4.*((-900)+81.*k.^2.*rx.^2+2.*k.^4.*rx.^4).*ry.^2+ ...
  rx.^2.*(900+45.*k.^2.*rx.^2+k.^4.*rx.^4).*ry.^4+(-15).*(4+3.* ...
  k.^2.*rx.^2).*ry.^6)+3.*h1.*r.^(-11).*(rx.^6.*(40+(-11).*k.^2.* ...
  rx.^2+k.^4.*rx.^4)+rx.^4.*((-600)+124.*k.^2.*rx.^2+(-3).*k.^4.* ...
  rx.^4).*ry.^2+3.*rx.^2.*(200+10.*k.^2.*rx.^2+(-3).*k.^4.*rx.^4).* ...
  ry.^4+(-5).*(8+20.*k.^2.*rx.^2+k.^4.*rx.^4).*ry.^6+5.*k.^2.*ry.^8) ...
  );
sixth(:,:,2) = k.*rx.*ry.*(2.*h1.*r.^(-11).*(4.*rx.^4.*(90+(-21).*k.^2.*rx.^2+ ...
  k.^4.*rx.^4)+3.*rx.^2.*((-400)+52.*k.^2.*rx.^2+k.^4.*rx.^4).* ...
  ry.^2+6.*(60+30.*k.^2.*rx.^2+(-1).*k.^4.*rx.^4).*ry.^4+(-5).* ...
  k.^2.*(12+k.^2.*rx.^2).*ry.^6)+(-1).*h0.*k.*r.^(-10).*(k.^4.* ...
  rx.^8+(-15).*ry.^4.*((-24)+k.^2.*ry.^2)+75.*rx.^2.*ry.^2.*((-16)+ ...
  k.^2.*ry.^2)+k.^2.*rx.^6.*((-39)+2.*k.^2.*ry.^2)+rx.^4.*(360+51.* ...
  k.^2.*ry.^2+k.^4.*ry.^4)));
sixth(:,:,3) = k.*((-1).*h0.*k.*r.^(-10).*(6.*rx.^6.*((-10)+k.^2.*rx.^2)+rx.^4.*( ...
  900+(-69).*k.^2.*rx.^2+k.^4.*rx.^4).*ry.^2+rx.^2.*((-900)+(-15).* ...
  k.^2.*rx.^2+2.*k.^4.*rx.^4).*ry.^4+(60+57.*k.^2.*rx.^2+k.^4.* ...
  rx.^4).*ry.^6+(-3).*k.^2.*ry.^8)+(-1).*h1.*r.^(-11).*(k.^4.* ...
  rx.^10+(-9).*k.^2.*rx.^8.*(3+k.^2.*ry.^2)+rx.^4.*ry.^2.*((-30)+ ...
  k.^2.*ry.^2).*(60+k.^2.*ry.^2)+3.*ry.^6.*((-40)+7.*k.^2.*ry.^2)+ ...
  3.*rx.^6.*(40+116.*k.^2.*ry.^2+(-5).*k.^4.*ry.^4)+6.*rx.^2.* ...
  ry.^4.*(300+(-54).*k.^2.*ry.^2+k.^4.*ry.^4)));
sixth(:,:,4) = k.*rx.*ry.*((-3).*h1.*r.^(-11).*(k.^4.*rx.^8+(-2).*k.^2.*rx.^6.*( ...
  24+k.^2.*ry.^2)+rx.^4.*(240+112.*k.^2.*ry.^2+(-6).*k.^4.*ry.^4)+( ...
  -2).*rx.^2.*ry.^2.*(400+(-56).*k.^2.*ry.^2+k.^4.*ry.^4)+ry.^4.*( ...
  240+(-48).*k.^2.*ry.^2+k.^4.*ry.^4))+(-1).*h0.*k.*r.^(-10).*( ...
  k.^2.*rx.^6.*(27+k.^2.*ry.^2)+9.*ry.^4.*((-40)+3.*k.^2.*ry.^2)+ ...
  rx.^2.*ry.^2.*(1200+(-63).*k.^2.*ry.^2+k.^4.*ry.^4)+rx.^4.*((-360) ...
  +(-63).*k.^2.*ry.^2+2.*k.^4.*ry.^4)));
sixth(:,:,5) = k.*((-1).*h1.*r.^(-11).*(3.*rx.^6.*((-40)+7.*k.^2.*rx.^2)+6.* ...
  rx.^4.*(300+(-54).*k.^2.*rx.^2+k.^4.*rx.^4).*ry.^2+rx.^2.*((-30)+ ...
  k.^2.*rx.^2).*(60+k.^2.*rx.^2).*ry.^4+3.*(40+116.*k.^2.*rx.^2+(-5) ...
  .*k.^4.*rx.^4).*ry.^6+(-9).*k.^2.*(3+k.^2.*rx.^2).*ry.^8+k.^4.* ...
  ry.^10)+(-1).*h0.*k.*r.^(-10).*((-3).*k.^2.*rx.^8+6.*ry.^6.*((-10) ...
  +k.^2.*ry.^2)+rx.^2.*ry.^4.*(900+(-69).*k.^2.*ry.^2+k.^4.*ry.^4)+ ...
  rx.^6.*(60+57.*k.^2.*ry.^2+k.^4.*ry.^4)+rx.^4.*ry.^2.*((-900)+( ...
  -15).*k.^2.*ry.^2+2.*k.^4.*ry.^4)));
sixth(:,:,6) = k.*rx.*ry.*(2.*h1.*r.^(-11).*((-5).*k.^2.*rx.^6.*(12+k.^2.*ry.^2)+ ...
  6.*rx.^4.*(60+30.*k.^2.*ry.^2+(-1).*k.^4.*ry.^4)+4.*ry.^4.*(90+( ...
  -21).*k.^2.*ry.^2+k.^4.*ry.^4)+3.*rx.^2.*ry.^2.*((-400)+52.*k.^2.* ...
  ry.^2+k.^4.*ry.^4))+(-1).*h0.*k.*r.^(-10).*((-15).*k.^2.*rx.^6+ ...
  360.*ry.^4+(-39).*k.^2.*ry.^6+k.^4.*ry.^8+rx.^4.*(360+75.*k.^2.* ...
  ry.^2+k.^4.*ry.^4)+rx.^2.*ry.^2.*((-1200)+51.*k.^2.*ry.^2+2.* ...
  k.^4.*ry.^4)));
sixth(:,:,7) = k.*((-1).*h0.*k.*r.^(-10).*((-15).*rx.^6.*(4+3.*k.^2.*ry.^2)+ ...
  ry.^6.*(60+(-9).*k.^2.*ry.^2+k.^4.*ry.^4)+rx.^4.*ry.^2.*(900+45.* ...
  k.^2.*ry.^2+k.^4.*ry.^4)+rx.^2.*ry.^4.*((-900)+81.*k.^2.*ry.^2+2.* ...
  k.^4.*ry.^4))+3.*h1.*r.^(-11).*(5.*k.^2.*rx.^8+rx.^2.*ry.^4.*(( ...
  -600)+124.*k.^2.*ry.^2+(-3).*k.^4.*ry.^4)+ry.^6.*(40+(-11).*k.^2.* ...
  ry.^2+k.^4.*ry.^4)+(-5).*rx.^6.*(8+20.*k.^2.*ry.^2+k.^4.*ry.^4)+ ...
  rx.^4.*(600.*ry.^2+30.*k.^2.*ry.^4+(-9).*k.^4.*ry.^6)));

sixth  = 0.25*1i*sixth;
