function [firstpart, secondpart] = smooth_part_derivatives(k, rx, ry)
%CHNK.HELM2D.SMOOTH_PART_DERIVATIVES evaluate the derivatives of the smooth
% part of asymptotics of the modified biharmonic's green's function
% firstpart are derivatives of:
% 1/(2k^2)*((-1/(2*pi))*(log(k/2) + C)* \sum_{k = 0}^{5}
% ((-1)^k/(k!)^2)*(k*r/2)^{2k} + (1/(2*pi))*(log(k/2) + C)* \sum_{k = 0}^{5}
% (1/(k!)^2)*(k*r/2)^{2k}). (r = |x-y|)
%
% secondpart are derivatives of: 
% 1/(2k^2)*(1/(2*pi)*sum_{k =1}^{5} a_{k} ((-1)^k/(k!)^2)*(k*r/2)^{2k} -
% 1/(2*pi)*sum_{k =1}^{5} a_{k} (1/(k!)^2)*(k*r/2)^{2k})
% with a_k = sum_{m =1}^{k} (1/m) and r = |x-y|.
% 
% Derivatives list in the order of: 
% f_{x1x1x1y1}, f_{x1x1x1y2}, f_{x1x1x2y2}, f_{x1x2x2y2}, f_{x2x2x2y2}

rx2 = rx.*rx;
ry2 = ry.*ry;

r2 = rx2+ry2;

r = sqrt(r2);

[m,n] = size(rx);

if nargout > 0
   firstpart = zeros(m, n, 5);

   firstpart(:, :, 1) = -(double(eulergamma) + log(k/2)).*(k^4).*(5*rx.^2 + ry.^2)./(64*pi);

   firstpart(:, :, 2) = -(double(eulergamma) + log(k/2)).*(k^4).*(rx.*ry)./(32*pi);

   firstpart(:, :, 3) = -(double(eulergamma) + log(k/2)).*(k^4).*(rx.^2 + ry.^2)./(64*pi);

   firstpart(:, :, 4) = -(double(eulergamma) + log(k/2)).*(k^4).*(rx.*ry)./(32*pi);

   firstpart(:, :, 5) = -(double(eulergamma) + log(k/2)).*(k^4).*(rx.^2 + 5*ry.^2)./(64*pi);
end

if nargout > 1
   secondpart = zeros(m, n, 5);

   secondpart(:, :, 1) = 1/(4*pi*k^2).*(-(9*k^4)/16 - (11/13824).*(k^6).*(-288.*rx.^2 -72*r2) + ...
       (25/1769472)*(k^8).*(-384*rx.^4 - 1152*(rx.^2).*r2 - 144*r2.^2) - ...
       (137/884736000)*(k^10).*(-1920*(rx.^4).*r2 - 2880*(rx.^2).*(r2.^2) - 240*(r2.^3))) -...
        1/(4*pi*k^2).*(-(9*k^4)/16 + (11/13824).*(k^6).*(-288.*rx.^2 -72*r2) + ...
       (25/1769472)*(k^8).*(-384*rx.^4 - 1152*(rx.^2).*r2 - 144*r2.^2) + ...
       (137/884736000)*(k^10).*(-1920*(rx.^4).*r2 - 2880*(rx.^2).*(r2.^2) - 240*(r2.^3)));

   secondpart(:, :, 2) = 1/(4*pi*k^2).*(-(25/1769472)*(k^8).*(-384.*(rx.^3).*ry - 576.*rx.*r2.*ry) +...
       (137/884736000)*(k^10).*(-1920*(rx.^3).*r2.*ry - 1440*rx.*(r2.^2).*ry) -...
       (11/96)*(k^6).*rx.*ry) +...
        1/(4*pi*k^2).*(-(25/1769472)*(k^8).*(-384.*(rx.^3).*ry - 576.*rx.*r2.*ry) -...
       (137/884736000)*(k^10).*(-1920*(rx.^3).*r2.*ry - 1440*rx.*(r2.^2).*ry) +...
       (11/96)*(k^6).*rx.*ry);

   secondpart(:, :, 3) = 1/(4*pi*k^2).*(-(25/221184)*(k^8).*rx.*(-72*r2.*ry - 48*(ry.^3)) + ...
       (137/884736000)*(k^10).*(rx.*(-144*(r2.^2).*ry - 192*r2.*(ry.^3)))-...
       (11/96)*(k^6).*rx.*ry) + ...
       1/(4*pi*k^2).*((25/221184)*(k^8).*rx.*(-72*r2.*ry - 48*(ry.^3)) - ...
       (137/884736000)*(k^10).*(rx.*(-144*(r2.^2).*ry - 192*r2.*(ry.^3))) +...
       (11/96)*(k^6).*rx.*ry) ;

   secondpart(:, :, 4) = 1/(4*pi*k^2).*(-(25/221184)*(k^8).*rx.*(-72*r2.*ry - 48*(ry.^3)) + ...
       (137/884736000)*(k^10).*(rx.*(-144*(r2.^2).*ry - 192*r2.*(ry.^3)))-...
       (11/96)*(k^6).*rx.*ry) + ...
       1/(4*pi*k^2).*((25/221184)*(k^8).*rx.*(-72*r2.*ry - 48*(ry.^3)) - ...
       (137/884736000)*(k^10).*(rx.*(-144*(r2.^2).*ry - 192*r2.*(ry.^3))) +...
       (11/96)*(k^6).*rx.*ry) ;

   secondpart(:, :, 5) =  1/(4*pi*k^2).*(-(9*k^4)/16 - (11/13824).*(k^6).*(-288.*ry.^2 -72*r2) + ...
       (25/1769472)*(k^8).*(-384*ry.^4 - 1152*(ry.^2).*r2 - 144*r2.^2) - ...
       (137/884736000)*(k^10).*(-1920*(ry.^4).*r2 - 2880*(ry.^2).*(r2.^2) - 240*(r2.^3))) -...
        1/(4*pi*k^2).*(-(9*k^4)/16 + (11/13824).*(k^6).*(-288.*ry.^2 -72*r2) + ...
       (25/1769472)*(k^8).*(-384*ry.^4 - 1152*(ry.^2).*r2 - 144*r2.^2) + ...
       (137/884736000)*(k^10).*(-1920*(ry.^4).*r2 - 2880*(ry.^2).*(r2.^2) - 240*(r2.^3)));

end



end